
# 铁路控制系统的信息安全
D B Milligan*
* Interfleet Technology Limited UK, (part of SNC Lavalin Inc)
9A Devonshire Square, London, EC2M 4YN
Milligan.D@Interfleet.co.uk

## 关键词：信息安全，控制，管理，轨道交通，网络安全管理系统。

## 摘要

本文介绍了实现一个基于软件的铁路信号控制系统（RCS）的网络安全管理系统（CSMS）的关键环节。它强调了RCS在信息安全的交付过程中遇到的困难，并提供了可能的方法，以确保系统的信息安全，并保证实用的网络安全风险管理方法得到遵守且能在系统的整个生命期间有效地持续。本文的观察结果来源于作者过去二十年参与的伦敦城市轨道交通信号控制系统项目。

## 1 背景

### 1.1 铁路中的安全性
在以前，铁路信号和信号控制系统的基本标准始终是安全性、可操作性、可维护性、可靠性和适用性。具体到铁路行业，应用软件的可靠性、可用性、可维修性和安全性（RAMS）标准EN50126 [ 1 ]也迫使供应商考虑安全性在设计软件中的应用；在标准EN50129 [ 2 ]中，电子应用安全要求也更多，它会影响系统的安全性评估。不幸的是，这些标准不强制要求的安全和网络安全的要求和流程必须到位，以至于他们对损失的缓解远远不够。安全（safety）当然是最重要的，但是，即使系统是安全的（safety），如果重复和重大的信息安全漏洞导致其提供的服务的可用性差和不可靠，轨道交通运营商同样将无法吸引客户。

### 1.2 早期的信息安全
在过去，信息安全意味着提供物理隔离，如上锁的行李架和房间，口令登录系统、信息错误检查和供应商依赖的“专有”和“秘密”消息协议。最近，由于需要降低成本、提高规模、并利用新兴的商用现成技术（COTS）及其内置的优势（和弱点），在系统信息安全方面需要更加警惕。

### 1.3 如今的信息安全
由于普遍采用COTS平台、经过验证的消息协议和操作系统（如微软（MS）Windows），现代RCS比过去脆弱得多。现在，所有参与交付和使用此类系统的人都必须充分了解信息安全问题、他们系统中真正的脆弱性和威胁，以及网络安全的具体细微之处。这不是经常发生的，部分原因是现有行业或具体应用标准不成熟，但更重要的是由于供应合同缺乏明确性，整个供应链、项目和运营商组织缺乏足够的网络安全能力。

### 1.4 合同中的信息安全问题
所有RCS供应商的合同中包括信息安全设备和安全要求和应遵循的标准，如“工业通信网络–网络和工业自动化控制系统系统安全标准iec62443（IACS）[ 3 ]。然而，客户通常不指定系统平台，该平台通常构建在不安全的平台上，如MS Windows，并使用易受攻击的协议（如TCP/IP）。如果合同不需要广泛的网络安全管理，客户可能会试图信任供应商和他们的保证，他们已经考虑到安全性。
更不清楚的是，无论是客户还是供应链，都没有足够的内部专门知识，也没有在构建过程中充分评估任何高级别安全策略或工程安全框架的应用。供应商也没有义务确保其系统的用户遵循最适当的做法，使系统处于安全状态。

### 1.5不安全的结果
结果可能是不充分的，例如“我们在你的外部接口上提供了一个防火墙”，它基于各种简单的、未经验证的或不可持续的网络安全管理过程。此外，如果客户有业务人员缺乏足够的安全培训和缺乏足够的安全程序（包括定期审计），结果实际上是一个不安全的解决方案。这样将造成一个系统极易受到破坏——在某种程度上系统遭到破坏可能只是时间问题。
### 1.6成本
从一个真实或疑似的漏洞可明显损害供应商或运营商的声誉。此外，在系统被投入使用后，增加系统安全性的成本将大大超过最初花费在设计上的初始费用。事件本身所造成的损害也可能与恢复有关。
额外的设计、风险管理和所需的安全专门知识的成本将很容易在一个大型信令供应合同中增加数十万英镑，它将成为一项不可避免的开支，需要由合适的业务案例支持的安全管理计划。这就是为什么为了安全设计的需要而进行早期管理买入太重要和明智的原因。

## 2 确保系统安全

值得关注的是，典型的RCS供应项目如何以安全为核心。 这需要描述系统的外观，所有涉及系统交付和操作的利益相关者，其次是要做一个概述，特别是项目团队如何实现预期结果 - 一个安全系统 – 以及在等待负责这种安全措施的领导者方面存在哪些缺陷和限制。

### 2.1系统
首要任务是确定系统及其预期的使用模式，并画出简单的网络图（在[4]的A2.3.3.8.4部分中建议）。 它可能如下图所示（图1）：
![3-1](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-1.png)
图1：铁路控制系统实例

这必须在概念设计阶段的早期完成，包括识别所有功能需求，所有接口，操作系统，网络设备，通信协议，设备驱动程序和应用软件。 项目交付工程师是整个交付安全RCS的“支持者”，必须在供应商的系统架构师的这个阶段紧密合作。
交付过程中可能遇到的第一个困难是供应商的设计可能仍然有些缺乏细节 - 这需要纳入安全风险管理流程。

### 2.2利益相关者

下一步涉及确定谁将参与系统的交付和使用。

#### 2.2.1供应商
供应商将有许多贡献者，包括系统设计和验证工程师，安全保障工程师，软件和硬件工程师，项目和成本控制管理（谁可以影响实际设计'安全'需要花费多少精力，因为这可能被视为低优先级）以及安装、测试和调试操作人员和技术编写人员的下游参与者提供操作和维护培训和指导文档。
即使这被认为是系统工程师（客户）和供应商[5]的主要职责，安全及其相关防护措施很可能不会成为设计人员考虑的前沿。

#### 2.2.2项目交付

项目交付团队将拥有该系统的“支持者”，可能是指定的安全机构（来自系统和软件部门）；这个人可能还会担任RCS验收工程师，提供保证和移交（使用）流程的建议。 保证可能要求将任何剩余安全风险的安全影响记录在案并传递给危险日志中的操作员。

面临的挑战是需要平衡a）系统整个生命周期的“安全”要求与b）按时间和预算交付RCS的计划和成本压力，以及与维护系统在一个安全状态的相关实际限制。

#### 2.2.3操作人员和维护人员

该项目必须在所有阶段包括运营商及其资产工程师，工程部门，RCS系统安全负责人，维护人员和培训师。 维护者是关键的利益相关者，因为他们必须在专家转入下一个项目之后很长时间遵循良好的安全实践，从而长期保持系统安全。

#### 2.2.4独立安全专家（ISE）

在可能的情况下，建议项目征集独立安全专家（ISE）的服务以加强接受和保证流程。 该项目必须对ISE参与程度做出判断 - 该决定可能基于成本和计划限制。

## 3 网络安全管理系统（CSMS）

### 3.1 目标
一旦系统，其目的和用户被了解，就必须实施和记录网络安全管理系统（CSMS），包括所有需要的物理安全措施。 它将涵盖RCS的整个生命周期。

### 3.2 方法
CSMS系统的组件可以在下面的图2看到。
![3-2](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-2.png)
图2：RCS网络安全管理系统模型

建立CSMS的模型基于IEC62443安全标准的第2-1部分[4]的附录B（并且参考信息安全管理标准IEC17799：2005 [6]及其后续IEC27001 [7]）。
 
项目成本的限制可能会迫使安全设计“负责人”来简化CSMS--这看起来很鲁莽，但通常情况是这样。 这在NIST的“工业控制系统（ICS）安全指南”[8]中已经注明，并且必须在该CSMS中内置最经济，实用和有效的过程。

### 3.3 初始系统的安全性
![3-3](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-3.png)
图3：初始RCS网络图
如图3所示，开发了一个更详细的网络图，其中显示了一些初始安全功能（物理控制，区域，管道），以便既获取初始快照，又帮助确定CSMS总体风险评估考虑因素。

### 3.4 安全计划、政策和要求

通过实施一套合适的控制措施（包括政策、流程、程序、组织结构以及软件和硬件功能）来实现系统安全。 必要时，需要建立，实施，监督，审查和改进这些控制措施，以确保符合组织的具体安全和业务目标。
必须编写一份安全管理计划（策略）以捕捉上述步骤。 它将包括系统安全策略以及所有安全/网络安全要求以及任何其他RA考虑事项，如系统可用性目标和服务级别协议。 这也将阐述风险管理流程和风险评估的使用，以确定保护系统所需的控制措施。

### 3.5 安全风险管理
安全风险管理过程遵循工程安全管理的总体指导，也遵循安全标准中制定的指导原则，系统评估系统内置漏洞和系统威胁所带来的风险，并尝试对各种风险进行分类，并将任何不可接受的风险降低到“尽可能低”的水平（ALARP）。

安全风险的关键在于设定风险的“频率”(‘frequency’ of risks occurring )和这些风险的“严重程度”(‘severities’ of those risks)。 下表显示了频率和严重程度的典型定义。

![3-4](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-4.png)
表1安全性RA的频率范围
![3-5](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-5.png)
![3-6](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-6.png)
表2安全RA的严重性范围
 
这些标准必须考虑系统可用性，安全影响（尽管安全流程有助于正式解决这些风险）以及商业和商业影响（供应商违规，信誉损害，如果发生违规行为时进行正式调查的成本）。 在RA之前进行量化是实现“实际控制措施”的关键。
![3-7](https://github.com/GrowingGardenia/Information-Security-Paper-Reading/blob/master/picture/3-7.png)
图4显示控制措施的摘录
上面的图4用于向项目和运营团队演示如何将安全性主动设计到RCS中，并通过安全RA中确定的控制措施进行了改进。 在项目中多次重新访问此RA非常重要，并将其交给运营商，以便他们可以继续审查和管理剩余风险。
## 4 挑战和局限
### 4.1 供应商
与RCS供应商打交道的一个关键挑战是让他们充分履行其现有范围内的义务，或许作为RAMS流程的一部分，提供一个“安全”系统。 RCS供应商专门提供铁路软件应用，但网络仅仅是必要的平台，其安全性是事后考虑的。 威胁发展的速度远远大于RCS供应商生产新系统的速度，并且他们不太可能通过防御技术的最佳实践获得最新信息。 这些供应商在安全设计方面变得更加专业，但仍需要鼓励。
 
以下部分重点介绍面临的特殊挑战。
 
#### 4.1.1 阻力
 
由于增加了成本和时间，供应商可能会拒绝建立广泛的安全管理体系。尽管风险与做得太少有关，但也可能担心安全风险评估会暴露成本影响的问题，或者需要增强，这本身会使供应商付出代价。

#### 4.1.2 最小努力
 
供应商肯定会努力达到安全标准（威胁发展速度超过标准），但这在某种程度上可以作为论文练习或遵守程度较差的标准。英国一家私人机构最近的一项研究发现，其中只有25％“投资于至少一个（安全）标准的全面实施”[10]。
 
例如，很难确保供应商提供足够的设计师安全能力证据，并且已经实施了适当的ALARP安全风险管理流程，并延伸至其产品的整个生命周期。对于RCS“操作许可”证书可能没有简单的“清洁健康法案”。所有这些都必须在执行CSMS时加以解决。
 
理想情况下，供应商将参照有用的软件安全保护来源进行设计，例如“ 25 大危险软件错误”（CWE）[9]，SANS或MITRE-这些机构可以保持最新的在线信息。如果可能的话，还应该鼓励供应商参考英国国家基础设施保护中心（CPNI）发布的指导，该指南提供了“缓解恶意软件风险”的建议[11]。
#### 4.1.3 遗留系统惯性
 
供应商可能会拒绝制定适当的CSMS系统，只是基于该产品具有预定义和经过验证的体系结构，平台和产品并且没有明显的不安全性。这种态度忽略了这样一个事实，即即使产品不变，外部环境（例如COTS组件中已知的漏洞）也在变化。
 
#### 4.1.4 缺乏“终身设计”
 
供应商可能不承认他们有责任为客户提供可以通过补丁和升级计划在整个生命周期内获得保障的系统。供应商可能声明，即使用户看到从升级中获得的好处，也不鼓励保证和委托系统使用一般的MS Windows服务修补程序或升级，但偶尔可能会建议所有受影响的客户应用特定的修补程序为了保护他们的系统免受攻击。
 
不幸的是，没有控制和风险评估的测试，特别是在商业计划不太明确，技术支持不如初始项目那么容易的情况下，引入这种修补程序，尤其是在RCS的生命周期后期，会带来一些风险。这在IEC标准IAS 62443的IACS的补丁管理的第2-3部分详细阐述[12]。

### 4.2 项目

由于金钱，时间或合同限制，该项目往往缺乏激励来执行全面有效的CSMS。 这导致在工业网络安全论文中有详细记录的这一挑战，即说服高级交付团队必须提供财务承诺，以确保系统得到充分保证。
 
最终，“安全吗？”和“操作人员能否保证安全？”的测试必须包含在安全和运行准备阶段。 此外，必须重点确保“安全”的RCS不会不必要地昂贵或复杂以维持“安全”状态

### 4.3 经营者和维护者
 
作者的经验是，很难说服系统用户遵循项目团队提供的CSMS，包括提供适当的安全培训和程序，直到发生可疑的违规行为。 此外，随着时间的推移，系统和安全专长逐渐消失，持续的安全培训计划薄弱。

### 4.4 独立安全专家
 
如果没有专业和独立的安全专业知识，那么专家级别较低的利益相关者和项目团队可能很容易陷入虚假的安全感 - CSMS已到位，每个人都意识到风险，并已采取措施降低风险。 面临的挑战主要在于招聘，甚至在咨询的基础上，为项目的整个生命周期提供良好的ISE。

### 4.5 安全和系统保证
 
安全性和系统保证的性质是需要CSMS的证据，但不能保证证明其充分性。 然而，已经看到仅仅恶意软件流行率的增加导致了RCS合同的强化，需要在保证过程中对安全性进行更多的考虑。

## 5 使其工作的战略
### 5.1 负责人
 
建议在早期确定涉及的每个组织中的系统安全性的“负责人”。 这些负责人必须尽早准备升级CSMS中的任何缺陷，无论是供应商，交付团队还是运营商。

### 5.2 CSMS和政策，要求和标准
 
在执行CSMS时，重要的是保持该模型，参照它，重复更新风险评估并根据需要修改程序。安全专家必须随时了解安全标准和最佳实践的变化 - 删除易受攻击的实践或设备或进行轻微的重新配置可能会在风险较低且收益显著的情况下立即提高安全性。
 
### 5.3 风险管理
 
以正式方式管理风险是至关重要的，涉及重要学科专家的所有阶段：软件，网络，RAM和项目工程师，ISE，维护人员和培训人员。通过一个小的关键组开始风险评估过程有时更实际，然后允许更多的受众在正式审查过程（记录的评论和响应）下审查产出。 

### 5.4 设计
 
为了让系统及其运行环境得到充分理解，以下人员必须尽早面对面交流：项目工程师，ISE，供应商的硬件和软件设计人员，操作员和维护人员，这一点很重要。如果所有参与者都尝试降低系统复杂性（更容易保护），那么这种方法将效果最佳，在架构和软件设计方面提出挑战，并在保护系统的情况下对设计决策采取务实的态度。这样做的例子可能是：避免使用补丁，不使用TCP / IP或在边界使用空隙（数据二极管）。
 
最好的设计包括提供多级安全保护的“纵深防御”方法。这将减少任何违反对系统性能或可用性产生重大影响的可能性。整个生命周期的设计考虑因素必须针对潜在的补丁进行计在防火墙固件中，与安全性直接相关或具有安全隐患，即如果操作系统的补丁程序改变了防火墙的管理方式，那么风险评估或维护过程是否需要更新？
 
此外，当进行快速设备维修时，对平台的更改可能会对维护产生影响 - 优化“平均修复时间”或MTTR - 使用硬盘映像，这些映像在工厂中也可能使用防病毒软件扫描。图像可能已过时！ 
### 5.5 能力和培训
 
随着时间的推移，领域知识逐渐丧失或稀释，安全专业知识变得难以获得，强大的安全培训计划允许进行更新的安全培训，并定期审查控制措施和防火墙事件日志，这一点变得更加重要。
 
### 5.6 维护和审计
 
维护人员在应用现有安全程序（如密码管理，安全设备日志审计或定期渗透和漏洞测试）时可能会变得松懈。现在各组织正在考虑通过引入使用智能卡/引脚来降低一些访问和密码风险。审核和扫描本身通常被维护人员视为过于侵入性或耗时，没有足够的优先权，在全天候的运行环境中，因此必须进行务实的规划。
 
### 5.7 安全专业知识
 
始终值得交付具有铁路运营环境特定经验的安全专家，担任该项目的顾问或独立评估人员。他们可能会建议独立（例如“由道德黑客”）定期渗透和漏洞测试。

## 6 总结
从这个分析中可以清楚地看到，有一些简单的经验教训可以学习：
 
•CSMS：将CSMS建成项目大门。 
•合同：包含强大的安全要求。
•成本：支付适当的安全级别，通过详细和公正的商业案例证明合理。 
•设计漏洞 - 是否需要MS Windows？ 
•专业知识：支付良好的独立安全支持。 
•从可能的和有记录的违规中吸取教训并相应地改进程序。 
•实用主义：记住穷人的用户 - 他们至少需要了解安全性，因为他们在保持铁路运行方面还有很多其他问题。
 
所有参与设计和使用安全RCS的人员都需要适当的安全培训和能力才能担任他/她的角色，更重要的是，安全专家必须采取切实可行的方法来提供安全，安全且仍然可操作的系统，不会不必要地“锁定”并且实际上不可访问。
 
该系统生命周期中的关键设计，交付和运营机构必须以经济高效且可行的方式管理所涉及的硬件和软件的安全性，并且有权在正确的时间以正确的方式使事情发生，而不是只是为了适应供应商，安装人员或维护人员的需求。尽管采用了多少种控制措施，但系统越难保证，出错的可能性就越大。
## 致谢
作者要感谢Interfleet Technology Limited的Andrew Love（列车控制与信号主管）和Carine Marin（铁路控制系统ETCS负责人），伦敦地铁工程董事会的Anthony Cross（控制和信息资产工程师）和LeeJohn伦敦地下资本项目管理局的艾伦（项目工程经理）对他们的支持和有益的评论和建议。
References 
[1] EN 50126 Railway applications - The specification and demonstration of reliability, availability, maintainability and safety (RAMS).<br> 
[2] EN 50129 Railway applications - Communications, signalling and processing systems - Safety related electronic systems for signalling. <br>
[3] IEC62443 (was ISA-99) Industrial Communications Networks – Network and System Security. <br>
[4] Part 2-1 (2010) of IEC62443 Industrial Communications Networks – Network and System Security – Establishing an IACS security program.  <br>
[5] S1210 Safety Related Software, issue A2 (March 2014), a London Underground category 1 standard. <br>
[6] ISO/IEC17799 Information Technology – Security Techniques – Code of practice for Information Security Management. <br>
[7] ISO/IEC27001:2005 Information Technology – Security Techniques – Information Security Management Systems - Requirements. <br>
[8] National Institute of Standards Institute (NIST) NIST SP 800-82, ‘Guide to Industrial Control Systems (ICS) Security’. <br>
[9] Common Weakness Enumeration i.e. CWE’s “Top 25 Most Dangerous Software Errors” at http://cwe.mitre.org/top25/. <br>
[10] UK Cyber Security Standards Research Report, Nov. 2013, by pwc for UK Dept. for Business Innovation & Skills.<br>
[11] CPNI guidance document “Mitigating the Risk of Malicious Software” at website: http://www.cpni.gov.uk/documents/publications/2004/2004002-advice_malicious_software.pdf <br>
[12] ISA-TR62443-2-3 (IEC/TR 62443-2-3) Security for IACS - Patch management in the IACS Environment.<br>
